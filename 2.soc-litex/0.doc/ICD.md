**MAIN ICD Register Bank**  

**Memory** : 4 Gbit (512 MB) external DDR3 as “main RAM.”

All of the registers listed below live in the MAIN ICD bank, which is memory-mapped at `CSR_MAIN_BASE = CSR_BASE + 0x2000` (i.e. address `0xF000_2000`).
Each entry occupies one full 32-bit word in the CSR bus.  Only the bits shown under “Bits” are implemented; all other bit-positions are reserved and should be written as zero (reads return zero).

| Offset |   Bits   | Field                  | Access | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| :----: | :------: | :--------------------- | :----- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|  0x00  |   \[0]   | **BYPASS\_EN**         | RW     | 0 = CPU/DSP processing chain active (CORDIC → LPF → gains → …).<br>1 = raw bypass: input samples pass straight through, bypassing all processing.                                                                                                                                                                                                                                                                                                                                                                                                                           |
|        |  \[31:1] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x04  |  \[2:0]  | **MUX\_SEL**           | RW     | Select which of the five frequency paths is active (0…4).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|        |  \[31:3] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x08  |  \[2:0]  | **METHOD\_SEL**        | RW     | Choose one of five processing modes:<br> 1 = MCU out-of-loop: set channel CORDICs & gains, physics engine free-runs;<br> 2 = MCU in-loop (software): read raw input → compute raw output (SW math);<br> 3 = MCU in-loop (HW-accel): read angle & amplitude from HW, write angle & amplitude to HW (no SW math);<br> 4 = MCU servo (software): compute raw output → read raw input → compute amplitude (SW math);<br> 5 = MCU servo (HW-accel): write angle & amplitude to HW, measure amplitude from HW (no SW math). |
|        |  \[31:3] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x0C  |  \[18:0] | **CORDIC\_TX\_PHASE0** | RW     | 19-bit phase increment for TX path 0.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x10  |  \[18:0] | **CORDIC\_TX\_PHASE1** | RW     | 19-bit phase increment for TX path 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x14  |  \[18:0] | **CORDIC\_TX\_PHASE2** | RW     | 19-bit phase increment for TX path 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x18  |  \[18:0] | **CORDIC\_TX\_PHASE3** | RW     | 19-bit phase increment for TX path 3.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x1C  |  \[18:0] | **CORDIC\_TX\_PHASE4** | RW     | 19-bit phase increment for TX path 4.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x20  |  \[18:0] | **CORDIC\_RX\_PHASE0** | RW     | 19-bit phase increment for RX path 0.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x24  |  \[18:0] | **CORDIC\_RX\_PHASE1** | RW     | 19-bit phase increment for RX path 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x28  |  \[18:0] | **CORDIC\_RX\_PHASE2** | RW     | 19-bit phase increment for RX path 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x2C  |  \[18:0] | **CORDIC\_RX\_PHASE3** | RW     | 19-bit phase increment for RX path 3.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x30  |  \[18:0] | **CORDIC\_RX\_PHASE4** | RW     | 19-bit phase increment for RX path 4.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x34  |  \[11:0] | **GAIN0**              | RW     | 12-bit gain code for path 0 (unsigned).                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|        | \[31:12] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x38  |  \[11:0] | **GAIN1**              | RW     | 12-bit gain code for path 1 (unsigned).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|        | \[31:12] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x3C  |  \[11:0] | **GAIN2**              | RW     | 12-bit gain code for path 2 (unsigned).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|        | \[31:12] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x40  |  \[11:0] | **GAIN3**              | RW     | 12-bit gain code for path 3 (unsigned).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|        | \[31:12] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x44  |  \[11:0] | **GAIN4**              | RW     | 12-bit gain code for path 4 (unsigned).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|        | \[31:12] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x48  |  \[15:0] | **HS\_DBG\_ADDR**      | RW     | High-speed debug RAM address (word index).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|        | \[31:16] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x4C  |  \[31:0] | **HS\_DBG\_WDATA**     | RW     | High-speed debug RAM write data (32 bits).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|  0x50  |  \[31:0] | **HS\_DBG\_RDATA**     | R      | High-speed debug RAM read data (32 bits).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  0x54  |  \[15:0] | **LS\_DBG\_ADDR**      | RW     | Low-speed debug RAM address (word index).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|        | \[31:16] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x58  |  \[31:0] | **LS\_DBG\_WDATA**     | RW     | Low-speed debug RAM write data (32 bits).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  0x5C  |  \[31:0] | **LS\_DBG\_RDATA**     | R      | Low-speed debug RAM read data (32 bits).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|  0x60  |  \[18:0] | **AMPLITUDE\_ARCTAN**  | R      | 19-bit signed arctangent result from the CORDIC engine.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|        | \[31:19] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  0x64  |   \[0]   | **BUFFER\_LATCH**      | RW     | Buffer Latch                                                                                                                                                                                                                                                                                                                                                                                                        |
|        |  \[31:1] | *(reserved)*           | —      | —                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |



## TODO:
- [x] Specify the 5 processing modes in the ICD
- [x] Specify RAM memory capacity
- [ ] Figure for GAIN to have a clearer picture
- [x] Add 5x CORDIC_RX and CORDIC_TX registers to ICD
- [x] Add Buffer/Latch register to ICD
- [x] Add Amplitude ArcTan register to ICD
